<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        * {
            padding: 0;
            margin: 0;
        }
    </style>
</head>
<body>
    <canvas id="canvas" width="800" height="400"></canvas>
    <script>
        window.onload = function(){
            var canvas = document.getElementById('canvas');
            var context = canvas.getContext('2d');
            console.log(context);
            
            console.log(context.canvas.width, context.canvas.height);

            sourceIn();
            context.save();
            context.font = '30pt Arial';            
            context.globalAlpha = 0.6;
            context.fillStyle = 'red';
            context.strokeStyle = 'red';
            
            context.fillText('测试', 100, 100);
            context.strokeText('测试', 100, 100);
            context.restore();

            //globalCompsiteOperation
            //globalCompositeOperation 属性设置或返回如何将一个源（新的）图像绘制到目标（已有）的图像上。
            // 源图像 = 您打算放置到画布上的绘图。
            // 目标图像 = 您已经放置在画布上的绘图。
            // 值	           描述
            // source-over	默认。在目标图像上显示源图像。
            // source-atop	在目标图像顶部显示源图像。源图像位于目标图像之外的部分是不可见的。
            // source-in	在目标图像中显示源图像。只有目标图像内的源图像部分会显示，目标图像是透明的。
            // source-out	在目标图像之外显示源图像。只会显示目标图像之外源图像部分，目标图像是透明的。
            // destination-over	在源图像上方显示目标图像。
            // destination-atop	在源图像顶部显示目标图像。源图像之外的目标图像部分不会被显示。
            // destination-in	在源图像中显示目标图像。只有源图像内的目标图像部分会被显示，源图像是透明的。
            // destination-out	在源图像外显示目标图像。只有源图像外的目标图像部分会被显示，源图像是透明的。
            // lighter	显示源图像 + 目标图像。
            // copy	显示源图像。忽略目标图像。
            // xor	使用异或操作对源图像与目标图像进行组合。  

            context.globalAlpha = 1;
            context.font = '18pt Arial';   
            
            //1.source-over  
            context.save();
            context.fillStyle = 'black';                
            context.fillText('1.source-over', 20, 180);

            context.fillStyle = 'red';
            context.fillRect(20, 200, 100, 40);
            context.globalCompositeOperation  = 'source-over';        
            context.fillStyle = 'blue';
            context.fillRect(70, 220, 100, 40);   
            context.restore();
            //2.source-atop 
            context.save();
            context.fillStyle = 'black';                
            context.fillText('2.source-atop', 220, 180);

            context.fillStyle = 'red';
            context.fillRect(220, 200, 100, 40);
            context.globalCompositeOperation = 'source-atop';//影响后续所有绘图
            context.fillStyle = 'blue';
            context.fillRect(270, 220, 100, 40);
            context.restore();
 
            //3.source-in
            context.save();
            context.fillStyle = 'black';                
            context.fillText('3.source-in', 420, 180); 
            // context.fillStyle = 'red';
            // context.fillRect(420, 200, 100, 40);
            // context.globalCompositeOperation = 'source-in';
            // context.fillStyle = 'blue';
            // context.fillRect(470, 220, 100, 40);    
            context.restore();              
            function sourceIn(){
                context.save();
                context.fillStyle = 'red';
                context.fillRect(420, 200, 100, 40);
                context.globalCompositeOperation = 'source-in';
                context.fillStyle = 'blue';
                context.fillRect(470, 220, 100, 40);                 
                context.restore();                            
            }

            //4.source-out
            context.save();
            context.fillStyle = 'black';                 
            context.fillText('4.source-out', 620, 180); 
            context.restore();                     
        }
    </script>
</body>
</html>